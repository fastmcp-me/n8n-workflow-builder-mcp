{
  "nodeType": "n8n-nodes-base.microsoftTeamsTrigger",
  "displayName": "Microsoft Teams Trigger",
  "description": "Triggers workflows in n8n based on events from Microsoft Teams, such as new messages or team updates, using specified configurations.",
  "version": 1,
  "properties": [
    {
      "name": "event",
      "displayName": "Trigger On",
      "type": "options",
      "default": "newChannelMessage",
      "description": "A new channel is created",
      "options": [
        {
          "name": "New Channel",
          "value": "newChannel",
          "description": "A new channel is created"
        },
        {
          "name": "New Channel Message",
          "value": "newChannelMessage",
          "description": "A message is posted to a channel"
        },
        {
          "name": "New Chat",
          "value": "newChat",
          "description": "A new chat is created"
        },
        {
          "name": "New Chat Message",
          "value": "newChatMessage",
          "description": "A message is posted to a chat"
        },
        {
          "name": "New Team Member",
          "value": "newTeamMember",
          "description": "A new member is added to a team"
        }
      ]
    },
    {
      "name": "watchAllTeams",
      "displayName": "Watch All Teams",
      "type": "boolean",
      "default": false,
      "description": "Whether to watch for the event in all the available teams",
      "displayOptions": {
        "show": {
          "event": [
            "newChannel",
            "newChannelMessage",
            "newTeamMember"
          ]
        }
      }
    },
    {
      "name": "teamId",
      "displayName": "Team",
      "type": "resourceLocator",
      "default": "{\n\t\t\t\t\tmode: 'list',\n\t\t\t\t\tvalue: '',\n\t\t\t\t}",
      "description": "Select a team from the list, enter an ID or a URL",
      "placeholder": "Select a team...",
      "required": true,
      "displayOptions": {
        "show": {
          "event": [
            "newChannel",
            "newChannelMessage",
            "newTeamMember"
          ],
          "watchAllTeams": [
            false
          ]
        }
      }
    },
    {
      "name": "watchAllChannels",
      "displayName": "Watch All Channels",
      "type": "boolean",
      "default": false,
      "description": "Whether to watch for the event in all the available channels",
      "displayOptions": {
        "show": {
          "event": [
            "newChannelMessage"
          ],
          "watchAllTeams": [
            false
          ]
        }
      }
    },
    {
      "name": "channelId",
      "displayName": "Channel",
      "type": "resourceLocator",
      "default": "{\n\t\t\t\t\tmode: 'list',\n\t\t\t\t\tvalue: '',\n\t\t\t\t}",
      "description": "Select a channel from the list, enter an ID or a URL",
      "placeholder": "Select a channel...",
      "required": true,
      "displayOptions": {
        "show": {
          "event": [
            "newChannelMessage"
          ],
          "watchAllTeams": [
            false
          ],
          "watchAllChannels": [
            false
          ]
        }
      }
    },
    {
      "name": "watchAllChats",
      "displayName": "Watch All Chats",
      "type": "boolean",
      "default": false,
      "description": "Whether to watch for the event in all the available chats",
      "displayOptions": {
        "show": {
          "event": [
            "newChatMessage"
          ]
        }
      }
    },
    {
      "name": "chatId",
      "displayName": "Chat",
      "type": "resourceLocator",
      "default": "{\n\t\t\t\t\tmode: 'list',\n\t\t\t\t\tvalue: '',\n\t\t\t\t}",
      "description": "Select a chat from the list, enter an ID or a URL",
      "placeholder": "Select a chat...",
      "required": true,
      "displayOptions": {
        "show": {
          "event": [
            "newChatMessage"
          ],
          "watchAllChats": [
            false
          ]
        }
      }
    }
  ],
  "credentialsConfig": [
    {
      "name": "microsoftTeamsOAuth2Api",
      "required": true
    },
    {
      "name": "default",
      "required": false
    },
    {
      "name": "event",
      "required": false
    },
    {
      "name": "watchAllTeams",
      "required": true
    },
    {
      "name": "watchAllChannels",
      "required": true
    },
    {
      "name": "watchAllChats",
      "required": true
    }
  ],
  "io": {
    "inputs": [],
    "outputs": [
      "Main"
    ],
    "outputNames": [],
    "hints": {}
  },
  "wiring": {
    "role": "generic",
    "requires": [],
    "optional": [],
    "consumedBy": [],
    "consumes": [],
    "produces": [
      "Main"
    ]
  }
}