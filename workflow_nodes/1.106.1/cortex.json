{
  "nodeType": "n8n-nodes-base.cortex",
  "displayName": "Cortex",
  "description": "Apply the Cortex analyzer/responder on the given entity",
  "version": 1,
  "properties": [
    {
      "name": "analyzer",
      "displayName": "Analyzer Type Name or ID",
      "type": "options",
      "default": "",
      "description": "Choose the analyzer. Choose from the list, or specify an ID using an <a href=\"https://docs.n8n.io/code/expressions/\">expression</a>.",
      "required": true,
      "displayOptions": {
        "show": {
          "resource": [
            "analyzer"
          ],
          "operation": [
            "execute"
          ]
        }
      }
    },
    {
      "name": "observableType",
      "displayName": "Observable Type Name or ID",
      "type": "options",
      "default": "",
      "description": "Choose the observable type. Choose from the list, or specify an ID using an <a href=\"https://docs.n8n.io/code/expressions/\">expression</a>.",
      "required": true,
      "displayOptions": {
        "show": {
          "resource": [
            "analyzer"
          ],
          "operation": [
            "execute"
          ]
        }
      }
    },
    {
      "name": "observableValue",
      "displayName": "Observable Value",
      "type": "string",
      "default": "",
      "description": "Enter the observable value",
      "required": true,
      "displayOptions": {
        "show": {
          "resource": [
            "analyzer"
          ],
          "operation": [
            "execute"
          ]
        }
      }
    },
    {
      "name": "binaryPropertyName",
      "displayName": "Put Output File in Field",
      "type": "string",
      "default": "data",
      "required": true,
      "displayOptions": {
        "show": {
          "observableType": [
            "file"
          ],
          "resource": [
            "analyzer"
          ],
          "operation": [
            "execute"
          ]
        }
      }
    },
    {
      "name": "tlp",
      "displayName": "TLP",
      "type": "options",
      "default": 2,
      "description": "The TLP of the analyzed observable",
      "options": [
        {
          "name": "White"
        },
        {
          "name": "Green"
        },
        {
          "name": "Amber"
        },
        {
          "name": "Red"
        }
      ],
      "displayOptions": {
        "show": {
          "resource": [
            "analyzer"
          ],
          "operation": [
            "execute"
          ]
        }
      }
    },
    {
      "name": "additionalFields",
      "displayName": "Additional Fields",
      "type": "collection",
      "default": {},
      "description": "Whether to force bypassing the cache",
      "placeholder": "Add Field",
      "options": [
        {
          "name": "force",
          "displayName": "Force",
          "type": "boolean",
          "default": false,
          "description": "Whether to force bypassing the cache"
        },
        {
          "name": "timeout",
          "displayName": "Timeout (Seconds)",
          "type": "number",
          "default": 3,
          "description": "Timeout to wait for the report in case it is not available at the time the query was made"
        }
      ],
      "displayOptions": {
        "show": {
          "resource": [
            "analyzer"
          ],
          "operation": [
            "execute"
          ]
        }
      }
    },
    {
      "name": "operation",
      "displayName": "Operation",
      "type": "options",
      "default": "execute",
      "description": "Choose an operation",
      "required": true,
      "options": [
        {
          "name": "Execute",
          "value": "execute",
          "description": "Execute Analyzer"
        }
      ],
      "displayOptions": {
        "show": {
          "resource": [
            "analyzer"
          ]
        }
      }
    },
    {
      "name": "jobId",
      "displayName": "Job ID",
      "type": "string",
      "default": "",
      "description": "ID of the job",
      "required": true,
      "displayOptions": {
        "show": {
          "resource": [
            "job"
          ],
          "operation": [
            "get",
            "report"
          ]
        }
      }
    },
    {
      "name": "responder",
      "displayName": "Responder Type Name or ID",
      "type": "options",
      "default": "",
      "description": "Choose the responder. Choose from the list, or specify an ID using an <a href=\"https://docs.n8n.io/code/expressions/\">expression</a>.",
      "required": true,
      "displayOptions": {
        "show": {
          "resource": [
            "responder"
          ]
        }
      }
    },
    {
      "name": "entityType",
      "displayName": "Entity Type Name or ID",
      "type": "options",
      "default": "",
      "description": "Choose the Data type. Choose from the list, or specify an ID using an <a href=\"https://docs.n8n.io/code/expressions/\">expression</a>.",
      "required": true,
      "displayOptions": {
        "show": {
          "resource": [
            "responder"
          ]
        }
      }
    },
    {
      "name": "jsonObject",
      "displayName": "JSON Parameters",
      "type": "boolean",
      "default": false,
      "description": "Choose between providing JSON object or seperated attributes",
      "displayOptions": {
        "show": {
          "resource": [
            "responder"
          ]
        }
      }
    },
    {
      "name": "objectData",
      "displayName": "Entity Object (JSON)",
      "type": "string",
      "default": "",
      "required": true,
      "displayOptions": {
        "show": {
          "resource": [
            "responder"
          ],
          "jsonObject": [
            true
          ]
        }
      }
    },
    {
      "name": "parameters",
      "displayName": "Parameters",
      "type": "fixedCollection",
      "default": {},
      "description": "Description of the case",
      "placeholder": "Add Parameter",
      "displayOptions": {
        "show": {
          "resource": [
            "responder"
          ],
          "jsonObject": [
            false
          ],
          "entityType": [
            "case"
          ]
        }
      }
    },
    {
      "name": "resource",
      "displayName": "Resource",
      "type": "options",
      "default": "analyzer",
      "description": "Choose a resource",
      "required": true,
      "options": [
        {
          "name": "Analyzer",
          "value": "analyzer"
        },
        {
          "name": "Job",
          "value": "job"
        },
        {
          "name": "Responder",
          "value": "responder"
        }
      ]
    }
  ],
  "credentialsConfig": [
    {
      "name": "cortexApi",
      "required": true
    },
    {
      "name": "resource",
      "required": false
    }
  ],
  "io": {
    "inputs": [
      "Main"
    ],
    "outputs": [
      "Main"
    ],
    "outputNames": [],
    "hints": {}
  },
  "wiring": {
    "role": "generic",
    "requires": [],
    "optional": [],
    "consumedBy": [],
    "consumes": [
      "Main"
    ],
    "produces": [
      "Main"
    ]
  }
}